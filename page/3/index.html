<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>点滴诗词</title>
    <meta name="author" content="shiguofu">
    <meta name="version" content="1.0.0">
    <meta name="keywords" content>
    <meta name="description" content="好玩有趣长知识">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

    
    <link rel="alternate" href="/atom.xml" title="点滴诗词" type="application/atom+xml">
    
    
    <link rel="icon" href="http://shiguofu.cn/favicon.ico">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <main class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">点滴诗词</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item active" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/categories/backend">
                <span class="nav-text">后端</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://shiguofu2012.github.io"></form>

        
        

        
        <div class="author-meta">
            
            <div class="author-avatar">
                <a href="/">
                    <img src="http://shiguofu.cn/static/images/diandi.jpg" title="公众号：itman-1">
                </a>
            </div>
            
            <div class="author-name">公众号：itman-1</div>
            <div class="author-work">程序猿，苦B奋斗的伪文艺老年</div>
            <div class="author-location">
                <i class="icon-location vm"></i>
                <span class="vm">wuhan, China</span>
            </div>
            
            <div class="author-thread-wrap">
                <div class="author-threads clearfix">
                    
                        <a class="thread-item" href="https://github.com/shiguofu2012" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M512 32.12c-265.004 0-479.88 220.23-479.88 492.090 0 217.446 137.536 401.684 328.202 466.81 23.994 4.498 32.778-10.712 32.778-23.78 0-11.782-0.428-42.632-0.642-83.764-133.466 29.778-161.744-65.984-161.744-65.984-21.852-56.772-53.344-71.982-53.344-71.982-43.49-30.636 3.214-29.992 3.214-29.992 48.202 3.428 73.482 50.772 73.482 50.772 42.846 75.196 112.258 53.558 139.68 40.918 4.284-31.706 16.71-53.558 30.42-65.77-106.474-12.426-218.516-54.63-218.516-243.152 0-53.772 18.638-97.69 49.274-131.966-4.928-12.426-21.424-62.556 4.714-130.252 0 0 40.276-13.282 131.966 50.344 38.348-10.926 79.266-16.282 120.184-16.496 40.704 0.214 81.836 5.57 120.184 16.496 91.692-63.626 131.752-50.344 131.752-50.344 26.136 67.698 9.64 117.828 4.714 130.252 30.636 34.492 49.274 78.408 49.274 131.966 0 188.952-112.258 230.514-219.16 242.724 17.138 15.21 32.564 45.202 32.564 91.048 0 65.77-0.642 118.898-0.642 134.966 0 13.068 8.57 28.492 32.992 23.566 191.094-64.912 328.418-249.152 328.418-466.382 0-271.86-214.874-492.090-479.88-492.090z"/>
</svg>

                        </a>
                    
                        <a class="thread-item" href="http://weibo.com/shiguofu2012" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M21.332 512c0-270.988 219.68-490.666 490.668-490.666s490.666 219.68 490.666 490.666c0 270.988-219.678 490.666-490.666 490.666s-490.666-219.678-490.666-490.666zM960 512c0-247.424-200.576-448-448-448s-448 200.576-448 448c0 247.424 200.576 448 448 448s448-200.576 448-448zM768 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.206-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.206 85.332 85.332 85.332zM512 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.206-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.204 85.332 85.332 85.332zM255.998 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.204-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.204 85.332 85.332 85.332z"/>
</svg>

                        </a>
                    
                        <a class="thread-item" href="https://twitter.com/shiguofu2012" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M512.029 31.011c-263.32 0-476.784 213.502-476.784 476.784 0 263.32 213.464 476.743 476.784 476.743s476.743-213.424 476.743-476.743c0-263.282-213.444-476.784-476.743-476.784zM752.193 411.663c0.251 5.151 0.349 10.319 0.349 15.548 0 158.786-120.856 341.85-341.85 341.85-67.844 0-131.021-19.884-184.188-53.961 9.41 1.104 18.955 1.665 28.656 1.665 56.305 0 108.115-19.208 149.221-51.425-52.567-0.987-96.925-35.741-112.22-83.468 7.32 1.433 14.85 2.149 22.595 2.149 10.959 0 21.569-1.433 31.656-4.201-54.987-11.035-96.402-59.634-96.402-117.796 0-0.524 0-1.025 0.020-1.549 16.186 9.003 34.716 14.404 54.427 15.044-32.258-21.587-53.458-58.317-53.458-100.023 0-22.015 5.925-42.673 16.264-60.408 59.266 72.683 147.807 120.527 247.676 125.521-2.053-8.77-3.118-17.968-3.118-27.378 0-66.333 53.787-120.14 120.158-120.14 34.561 0 65.771 14.599 87.69 37.93 27.378-5.363 53.091-15.393 76.305-29.16-9.003 28.074-28.036 51.618-52.858 66.47 24.338-2.903 47.495-9.37 69.024-18.917-16.070 24.144-36.459 45.306-59.945 62.248z"/>
</svg>

                        </a>
                    
                </div>
            </div>
            
        </div>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/09/11/hexo-image/">hexo引用图片无法显示</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="http://shiguofu2012.github.io/page/3/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-09-11T10:08:16.000Z" itemprop="datePublished">2019-09-11</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/hexo/">hexo</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>最近使用hexo，但是发现在文章中引用本地图片时总是显示不出来。</p>
<h4 id="插件安装与配置"><a href="#插件安装与配置" class="headerlink" title="插件安装与配置"></a>插件安装与配置</h4><p>首先我们需要安装一个图片路径转换的插件，这个插件名字是<strong>hexo-asset-image</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure>

<p>但是这个插件的内容需要修改，不然还是会出现图片无法显示的问题。</p>
<p>打开node_modules/hexo-asset-image/index.js，将内容更换为下面的代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">var</span> cheerio = <span class="built_in">require</span>(<span class="string">'cheerio'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosition</span>(<span class="params">str, m, i</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str.split(m, i).join(m).length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> version = <span class="built_in">String</span>(hexo.version).split(<span class="string">'.'</span>);</span><br><span class="line">hexo.extend.filter.register(<span class="string">'after_post_render'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> config = hexo.config;</span><br><span class="line">  <span class="keyword">if</span>(config.post_asset_folder)&#123;</span><br><span class="line">    	<span class="keyword">var</span> link = data.permalink;</span><br><span class="line">	<span class="keyword">if</span>(version.length &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">Number</span>(version[<span class="number">0</span>]) == <span class="number">3</span>)</span><br><span class="line">	   <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">'/'</span>, <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	   <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">'/'</span>, <span class="number">3</span>) + <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// In hexo 3.1.1, the permalink of "about" page is like ".../about/index.html".</span></span><br><span class="line">	<span class="keyword">var</span> endPos = link.lastIndexOf(<span class="string">'/'</span>) + <span class="number">1</span>;</span><br><span class="line">    link = link.substring(beginPos, endPos);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> toprocess = [<span class="string">'excerpt'</span>, <span class="string">'more'</span>, <span class="string">'content'</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; toprocess.length; i++)&#123;</span><br><span class="line">      <span class="keyword">var</span> key = toprocess[i];</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">var</span> $ = cheerio.load(data[key], &#123;</span><br><span class="line">        ignoreWhitespace: <span class="literal">false</span>,</span><br><span class="line">        xmlMode: <span class="literal">false</span>,</span><br><span class="line">        lowerCaseTags: <span class="literal">false</span>,</span><br><span class="line">        decodeEntities: <span class="literal">false</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      $(<span class="string">'img'</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> ($(<span class="keyword">this</span>).attr(<span class="string">'src'</span>))&#123;</span><br><span class="line">			<span class="comment">// For windows style path, we replace '\' to '/'.</span></span><br><span class="line">			<span class="keyword">var</span> src = $(<span class="keyword">this</span>).attr(<span class="string">'src'</span>).replace(<span class="string">'\\'</span>, <span class="string">'/'</span>);</span><br><span class="line">			<span class="keyword">if</span>(!<span class="regexp">/http[s]*.*|\/\/.*/</span>.test(src) &amp;&amp;</span><br><span class="line">			   !<span class="regexp">/^\s*\//</span>.test(src)) &#123;</span><br><span class="line">			  <span class="comment">// For "about" page, the first part of "src" can't be removed.</span></span><br><span class="line">			  <span class="comment">// In addition, to support multi-level local directory.</span></span><br><span class="line">			  <span class="keyword">var</span> linkArray = link.split(<span class="string">'/'</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> elem != <span class="string">''</span>;</span><br><span class="line">			  &#125;);</span><br><span class="line">			  <span class="keyword">var</span> srcArray = src.split(<span class="string">'/'</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> elem != <span class="string">''</span> &amp;&amp; elem != <span class="string">'.'</span>;</span><br><span class="line">			  &#125;);</span><br><span class="line">			  <span class="keyword">if</span>(srcArray.length &gt; <span class="number">1</span>)</span><br><span class="line">				srcArray.shift();</span><br><span class="line">			  src = srcArray.join(<span class="string">'/'</span>);</span><br><span class="line">			  $(<span class="keyword">this</span>).attr(<span class="string">'src'</span>, config.root + link + src);</span><br><span class="line">			  <span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info(<span class="string">"update link as:--&gt;"</span>+config.root + link + src);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info(<span class="string">"no src attr, skipped..."</span>);</span><br><span class="line">			<span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info($(<span class="keyword">this</span>));</span><br><span class="line">		&#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      data[key] = $.html();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>打开_config.yml文件，修改下述内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">post_asset_folder: true</span><br><span class="line">url: &lt;你的github page地址或者其他域名&gt;</span><br></pre></td></tr></table></figure>

<h4 id="重新生成"><a href="#重新生成" class="headerlink" title="重新生成"></a>重新生成</h4><h5 id="修改后，新建博客"><a href="#修改后，新建博客" class="headerlink" title="修改后，新建博客"></a>修改后，新建博客</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new test</span><br></pre></td></tr></table></figure>

<p>会发现在source/_posts目录中，新建了test.md与同名的文件夹(<strong>test</strong>)</p>
<h5 id="重新生成html文件，看到输出"><a href="#重新生成html文件，看到输出" class="headerlink" title="重新生成html文件，看到输出"></a>重新生成html文件，看到输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update link as:--&gt;//&lt;url&gt;/2019/09/11/xxxx/1568192562650.png</span><br></pre></td></tr></table></figure>

<p>访问即可看见图片出来啦！</p>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/09/11/jenkins部署nodejs/">jenkins</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="http://shiguofu2012.github.io/page/3/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-09-11T08:56:18.000Z" itemprop="datePublished">2019-09-11</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/service/">service</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h4 id="jenkins-安装"><a href="#jenkins-安装" class="headerlink" title="jenkins 安装"></a>jenkins 安装</h4><h5 id="jdk安装"><a href="#jdk安装" class="headerlink" title="jdk安装"></a>jdk安装</h5><ol>
<li>采用java8， 到官网下载jdk</li>
<li>解压配置， JAVA_HOME PATH，执行如下</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@wpspic5 ~]# java -version </span><br><span class="line">openjdk version "1.8.0_161"</span><br><span class="line">OpenJDK Runtime Environment (build 1.8.0_161-b14)</span><br><span class="line">OpenJDK 64-Bit Server VM (build 25.161-b14, mixed mode)</span><br></pre></td></tr></table></figure>

<h5 id="Jenkins-安装"><a href="#Jenkins-安装" class="headerlink" title="Jenkins 安装"></a>Jenkins 安装</h5><ol>
<li><strong>下载RPM包安装</strong></li>
</ol>
<p>jenkins安装也比较简单，有相应的rpm安装包</p>
<p><a href="https://pkg.jenkins.io/redhat-stable/" target="_blank" rel="noopener">官网地址</a> 选择合适的版本，下载安装</p>
<ol start="2">
<li><strong>yum安装</strong></li>
</ol>
<p>导入yum源</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo</span><br><span class="line">sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key</span><br></pre></td></tr></table></figure>

<p>安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install jenkins</span><br></pre></td></tr></table></figure>

<h4 id="jenkins-配置"><a href="#jenkins-配置" class="headerlink" title="jenkins 配置"></a>jenkins 配置</h4><p>默认端口号是8080，直接访问，会进行一些初始化，及插件的安装</p>
<p><img src="/2019/09/11/jenkins部署nodejs/1568192562650.png" alt="1568192488358"></p>
<p><strong>jenkins版本： 2.176.3-1.1</strong></p>
<ol>
<li><h4 id="部署节点配置"><a href="#部署节点配置" class="headerlink" title="部署节点配置"></a><strong>部署节点配置</strong></h4></li>
</ol>
<ul>
<li><p>进入jenkins主界面，点击左侧菜单的 “<strong>系统管理-&gt;系统设置</strong>”，拖动配置项到“Publish on ssh”</p>
</li>
<li><p>新增登录主机的ssh private key/ password的登录信息</p>
<p><img src="/2019/09/11/jenkins部署nodejs/jenkins-1.png" alt="jenkins-1"></p>
</li>
<li><p>增加节点，包括登录主机的用户名，IP地址，工作目录等, 可以新增多个节点</p>
<ul>
<li>Name: 主机标识符，用于区分</li>
<li>Hostname： 主机ip地址</li>
<li>Username: 登录主机的用户名</li>
<li>Remote Directory： 远端工作目录</li>
</ul>
</li>
</ul>
<p><img src="/2019/09/11/jenkins部署nodejs/jenkins-host.png" alt="jenkins-host"></p>
<ol start="2">
<li><h4 id="部署配置"><a href="#部署配置" class="headerlink" title="部署配置"></a><strong>部署配置</strong></h4></li>
</ol>
<ul>
<li><p>新建部署项，在主页左边栏，“<strong>新建任务</strong>“，起个有意义的名称，下面选择”<strong>自由风格的软件项目</strong>“</p>
<p>找到源码管理，配置Git 的Repo/credit(获取代码的key),  分支；</p>
<p>如果可以正常获取，不会出现提示</p>
<p><img src="/2019/09/11/jenkins部署nodejs/jenkins-source.png" alt="jenkins-source"></p>
<p>否则会出现如下提示，检查repo的配置是否写错误；检查key是不是有权限拉取代码</p>
</li>
</ul>
<p><img src="/2019/09/11/jenkins部署nodejs/jenkins-source-1.png" alt="jenkins-source-1"></p>
<ul>
<li><p>找到”<strong>构建</strong>“ 选项</p>
<ul>
<li>加入构建的命令，即打包操作（进入到工作目录，直接打包）</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd $WORKSPACE</span><br><span class="line">TAR_NAME=wps_eb_`date +%Y-%m-%d`.tar</span><br><span class="line">tar -cf $TAR_NAME ./</span><br></pre></td></tr></table></figure>

<ul>
<li>增加构建步骤，选择 ”send files or execute commands over SSH“, 采用ssh发送项目文件到目标机器并执行命令部署</li>
</ul>
<p><img src="/2019/09/11/jenkins部署nodejs/jenkins-build.png" alt="1567994464334"></p>
<ul>
<li>增加发送到目标机器后的操作命令，依赖于项目文件 (release/project_init.sh)</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">file_name=wps_eb_`date +%Y-%m-%d`.tar</span><br><span class="line">tmp_dir=/tmp/wps_eb_tmp</span><br><span class="line">log_dir=/data/log/pm2/wps_eb-admin</span><br><span class="line">echo $file_name</span><br><span class="line">sudo rm -rf  $tmp_dir</span><br><span class="line">sudo mkdir -p $tmp_dir</span><br><span class="line">sudo tar -xf /tmp/$file_name -C $tmp_dir ./release/*</span><br><span class="line">cd $tmp_dir/release</span><br><span class="line">sudo ./project_init.sh /tmp/$file_name</span><br></pre></td></tr></table></figure>



</li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/09/11/一些shell脚本/">一些shell脚本</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="http://shiguofu2012.github.io/page/3/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-09-11T06:50:17.000Z" itemprop="datePublished">2019-09-11</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/shell/">shell</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>最近在搞部署项目的功能，写了不少shell脚本，总结一下</p>
<h4 id="1-sftp上传支持多条命令，用awk分隔文件路径获取文件名称（-NF表示最后一列）"><a href="#1-sftp上传支持多条命令，用awk分隔文件路径获取文件名称（-NF表示最后一列）" class="headerlink" title="1. sftp上传支持多条命令，用awk分隔文件路径获取文件名称（$NF表示最后一列）"></a>1. sftp上传支持多条命令，用awk分隔文件路径获取文件名称（$NF表示最后一列）</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash                                                                                                                           </span><br><span class="line">function check() &#123;</span><br><span class="line">    if [ -z $1 ]; then</span><br><span class="line">        echo "please give the filename"</span><br><span class="line">        return</span><br><span class="line">    fi  </span><br><span class="line">    if [ ! -f $1 ]; then</span><br><span class="line">        echo "file not exists, exit..."</span><br><span class="line">        return</span><br><span class="line">    fi  </span><br><span class="line">    echo "ls" &gt; command.txt</span><br><span class="line">    echo "cd bj6-c-grb-screen-admin01/史国富" &gt;&gt; command.txt</span><br><span class="line">    echo "put $1" &gt;&gt; command.txt</span><br><span class="line">    filename=`echo $1 | awk -F/ '&#123;print $NF&#125;'`</span><br><span class="line">    echo $filename</span><br><span class="line">    echo "ls $filename" &gt;&gt; command.txt</span><br><span class="line">    sftp -P 2222 shiguofu@120.92.118.51 &lt; command.txt</span><br><span class="line">    echo "Done"</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">check $1</span><br></pre></td></tr></table></figure>

<h4 id="2-部署项目，未增加测试环境标识（sed修改），手动修改文件"><a href="#2-部署项目，未增加测试环境标识（sed修改），手动修改文件" class="headerlink" title="2. 部署项目，未增加测试环境标识（sed修改），手动修改文件"></a>2. 部署项目，未增加测试环境标识（sed修改），手动修改文件</h4><p>环境变量传入： 由于sudo 会重新初始化环境变量，因此，可以在脚本中传入执行的变量PATH等</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">WALLE_NODE=10.13.88.152</span><br><span class="line">WALLE_USER=root</span><br><span class="line">WALLE_PASSWD=1qaz@WSX</span><br><span class="line">zip_file_name=wps_eb_admin_`date +%Y%m%d%H%M%S`.tar</span><br><span class="line">remote_dest_dir=/tmp</span><br><span class="line">TEST_NODE=10.226.50.22</span><br><span class="line"></span><br><span class="line">function copy_to_walle()</span><br><span class="line">&#123;</span><br><span class="line">    echo "copy to $WALLE_NODE"</span><br><span class="line">    cd ..</span><br><span class="line">    echo "tar service files..."</span><br><span class="line">    tar -cf /tmp/$zip_file_name ./*</span><br><span class="line">    echo "Done. tar file -&gt; /tmp/$zip_file_name"</span><br><span class="line">    sshpass -p "$WALLE_PASSWD" scp /tmp/$zip_file_name $WALLE_USER@$WALLE_NODE:$remote_dest_dir</span><br><span class="line">    echo "copy to remote Done."</span><br><span class="line">    sshpass -p "$WALLE_PASSWD" ssh $WALLE_USER@$WALLE_NODE "</span><br><span class="line">    rm -rf /tmp/wps_eb_tmp</span><br><span class="line">    mkdir -p /tmp/wps_eb_tmp</span><br><span class="line">    tar -xf /tmp/$zip_file_name -C /tmp/wps_eb_tmp</span><br><span class="line">    "</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function deploy()</span><br><span class="line">&#123;</span><br><span class="line">    if [ -z $1 ]; then</span><br><span class="line">        echo "please give the ip address as the first param"</span><br><span class="line">        return</span><br><span class="line">    fi</span><br><span class="line">    USER=root</span><br><span class="line">    echo "deploy to test: $1"</span><br><span class="line">    echo "tar service files..."</span><br><span class="line">    tar -cf /tmp/$zip_file_name ./*</span><br><span class="line">    echo "Done. tar file -&gt; /tmp/$zip_file_name"</span><br><span class="line">    if [ ! -z $2 ]; then</span><br><span class="line">        USER=$2</span><br><span class="line">    fi</span><br><span class="line">    if [ ! -z $3 ]; then</span><br><span class="line">        sshpass -p "$3" scp /tmp/$zip_file_name $USER@$1:$remote_dest_dir</span><br><span class="line">        sshpass -p "$3" ssh $USER@$1 &lt;&lt; eeooff</span><br><span class="line">        sudo -i</span><br><span class="line">        tar -xf $remote_dest_dir/$zip_file_name -C /tmp/ ./release/*;</span><br><span class="line">        cd /tmp/release</span><br><span class="line">        PATH=$PATH:/usr/local/bin &amp;&amp; ./project_init.sh $remote_dest_dir/$zip_file_name</span><br><span class="line">eeooff</span><br><span class="line">    else</span><br><span class="line">        scp /tmp/$zip_file_name $USER@$1:$remote_dest_dir</span><br><span class="line">        echo "Done copy to remote host..."</span><br><span class="line">        ssh $USER@$1 &lt;&lt; eeooff</span><br><span class="line">        sudo -i</span><br><span class="line">        tar -xf $remote_dest_dir/$zip_file_name -C /tmp/ ./release/*;</span><br><span class="line">        cd /tmp/release</span><br><span class="line">        . /etc/profile &amp;&amp; ./project_init.sh $remote_dest_dir/$zip_file_name</span><br><span class="line">eeooff</span><br><span class="line">    fi</span><br><span class="line">    rm /tmp/$zip_file_name</span><br><span class="line">    # ./project_init.sh $remote_dest_dir/$zip_file_name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function deploy_test()</span><br><span class="line">&#123;</span><br><span class="line">    cd ..</span><br><span class="line">    sed -i 's/production/development/g' pm2.json</span><br><span class="line">    deploy 10.226.50.22 root 123456</span><br><span class="line">    sed -i 's/development/production/g' pm2.json</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo $1</span><br><span class="line">if [ -z $1 ]; then</span><br><span class="line">    deploy_test</span><br><span class="line">elif [ "$1" == "walle" ]; then</span><br><span class="line">    copy_to_walle</span><br><span class="line">else</span><br><span class="line">    cd ..</span><br><span class="line">    deploy $1 $2 $3</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h4 id="3-初始化服务环境，安装必要的包"><a href="#3-初始化服务环境，安装必要的包" class="headerlink" title="3. 初始化服务环境，安装必要的包"></a>3. 初始化服务环境，安装必要的包</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash                                                                                                                                                                    </span><br><span class="line">SOFT_DIR=/data/soft</span><br><span class="line"> </span><br><span class="line">function install_webp()&#123;</span><br><span class="line">    cd $SOFT_DIR</span><br><span class="line">    wget https://storage.googleapis.com/downloads.webmproject.org/releases/webp/libwebp-1.0.3-linux-x86-64.tar.gz</span><br><span class="line">    tar -xf libwebp-1.0.3-linux-x86-64.tar.gz</span><br><span class="line">    cd libwebp-1.0.3-linux-x86-64/bin</span><br><span class="line">    if [ -f /usr/bin/cwebp ]; then</span><br><span class="line">        mv /usr/bin/cwebp /usr/bin/cweb.bak</span><br><span class="line">    fi</span><br><span class="line">    cp cwebp /usr/bin/</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function install_node()&#123;</span><br><span class="line">    cd $SOFT_DIR</span><br><span class="line">    wget https://nodejs.org/dist/v10.13.0/node-v10.13.0-linux-x64.tar.xz</span><br><span class="line">    tar xvf node-v10.13.0-linux-x64.tar.xz</span><br><span class="line">    echo "export PATH=$PATH:$SOFT_DIR/node-v10.13.0-linux-x64/bin" &gt;&gt; /etc/profile</span><br><span class="line">    echo "export NODE_PATH=/data/soft/node-v10.13.0-linux-x64/lib/node_modules" &gt;&gt; /etc/profile</span><br><span class="line">    source /etc/profile</span><br><span class="line">    npm install pm2 -g</span><br><span class="line">    echo "10.13.0.29 wpsgit.kingsoft.net" &gt;&gt; /etc/hosts</span><br><span class="line">    echo "10.13.0.98 cdnshow.wpsop.kingsoft.net" &gt;&gt; /etc/hosts</span><br><span class="line">    echo "120.92.115.93 suc.kso.kingsoft.net" &gt;&gt; /etc/hosts</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span> mongodb 下载地址：https://repo.mongodb.org/yum/redhat/7/mongodb-org/3.4/x86_64/RPMS/ </span><br><span class="line"> </span><br><span class="line">if [ ! -d $SOFT_DIR ];then</span><br><span class="line">    rm -rf $SOFT_DIR</span><br><span class="line">    mkdir -p $SOFT_DIR</span><br><span class="line">fi</span><br><span class="line">which cwebp                                     # 采用which判断是否存在，获取返回值</span><br><span class="line">code=`echo $?`</span><br><span class="line">echo $code</span><br><span class="line">if [ $code != 0 ]; then</span><br><span class="line">    install_webp</span><br><span class="line">fi</span><br><span class="line">which npm</span><br><span class="line">code=`echo $?`</span><br><span class="line">if [ $code != 0 ]; then</span><br><span class="line">    install_node</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h4 id="4-服务初始化脚本"><a href="#4-服务初始化脚本" class="headerlink" title="4. 服务初始化脚本"></a>4. 服务初始化脚本</h4><p>服务需要sudo 执行， 增加了source 初始化环境的头</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">source /etc/profile</span><br><span class="line"> </span><br><span class="line">function init()</span><br><span class="line">&#123;</span><br><span class="line">    if [ ! -z $1 ] &amp;&amp; [ -d $1 ]; then</span><br><span class="line">        final_dir=$1;</span><br><span class="line">    else</span><br><span class="line">        echo "$1 did not exists... exit"</span><br><span class="line">        return</span><br><span class="line">    fi  </span><br><span class="line">    echo "install package..."</span><br><span class="line">    cd $1</span><br><span class="line">    if [ ! -z $2 ]; then</span><br><span class="line">        sed -i "s/production/$2/g" pm2.json</span><br><span class="line">    fi  </span><br><span class="line">    source /etc/profile</span><br><span class="line">    npm config set @wps:registry http://120.92.93.69:4873</span><br><span class="line">    npm install --no-save --production</span><br><span class="line">    npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line">    cnpm install canvas</span><br><span class="line">    echo "install Done."</span><br><span class="line">    echo "stop service wps-eb.."</span><br><span class="line">    sh -c 'source /etc/profile &amp;&amp; pm2 delete wps_eb-admin' &amp;&gt;/tmp/pm2.log</span><br><span class="line">    echo "stopped"</span><br><span class="line">    sleep 1</span><br><span class="line">    echo "start service wps-eb"</span><br><span class="line">    sh -c 'source /etc/profile &amp;&amp; pm2 start pm2.json' &amp;&gt;/tmp/pm2.log</span><br><span class="line">    echo "start Done."</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">function deploy_by_tar()</span><br><span class="line">&#123;</span><br><span class="line">    release_dir=/data/www</span><br><span class="line">    dest_dir=/data/release/wps_ebook_admin/`date +%Y%m%d-%H%M%S`</span><br><span class="line">    final_wps_ebook_dir=$release_dir/wps_ebook_admin</span><br><span class="line">    if [ ! -z $1 ] &amp;&amp; [ -f $1 ]; then</span><br><span class="line">        echo "deploy with $1..."</span><br><span class="line">        zip_file_name=$1</span><br><span class="line">    else</span><br><span class="line">        echo "$1 did not exists... exit"</span><br><span class="line">        return</span><br><span class="line">    fi  </span><br><span class="line">    mkdir -p $release_dir</span><br><span class="line">    mkdir -p $dest_dir</span><br><span class="line">    echo "untar package to $dest_dir"</span><br><span class="line">    `tar -xf $zip_file_name -C $dest_dir`</span><br><span class="line">    echo "untar Done."</span><br><span class="line">    echo "ln -sfn $dest_dir $final_wps_ebook_dir"</span><br><span class="line">    ln -sfn $dest_dir $final_wps_ebook_dir</span><br><span class="line">    echo 'Done.'</span><br><span class="line">    init $final_wps_ebook_dir $2</span><br><span class="line">    rm $zip_file_name</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">./init_env.sh</span><br><span class="line">deploy_by_tar $1 $2</span><br></pre></td></tr></table></figure>


        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/09/04/shell知识点/">shell知识点.md</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="http://shiguofu2012.github.io/page/3/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-09-04T07:25:01.000Z" itemprop="datePublished">2019-09-04</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/shell/">shell</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h4 id="1-shell函数参数传递不需要在参数列表，是通过-1-2…-这样获取，如"><a href="#1-shell函数参数传递不需要在参数列表，是通过-1-2…-这样获取，如" class="headerlink" title="1. shell函数参数传递不需要在参数列表，是通过$1, $2….这样获取，如"></a>1. shell函数参数传递不需要在参数列表，是通过$1, $2….这样获取，如</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"></span><br><span class="line">function deploy_one_host()                           # 函数定义，小括号不是必须的</span><br><span class="line">&#123;</span><br><span class="line">    cd wps_pic</span><br><span class="line">    zip_file_name=wps_pic_`date +%Y%m%d%H%M%S`.zip</span><br><span class="line">    zip "$zip_file_name" ./* -q</span><br><span class="line">    scp $zip_file_name root@$1:/tmp                  # 获取第一个参数</span><br><span class="line">    ssh root@$1 "sh exec.sh $zip_file_name;"         # ssh 在远端执行命令，多个以分号分隔</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">deploy_one_host 10.229.26.143                       # 传递一个参数，多个可在后面添加，以空格分隔</span><br></pre></td></tr></table></figure>

<h4 id="2-shell-命令行参数"><a href="#2-shell-命令行参数" class="headerlink" title="2. shell 命令行参数"></a>2. shell 命令行参数</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"></span><br><span class="line">echo $1, $2       # 获取命令行参数，第一个第二个， 如果没有就为空</span><br></pre></td></tr></table></figure>

<p>执行：</p>
<p>./exec.sh a b</p>
<h4 id="3-if-判断"><a href="#3-if-判断" class="headerlink" title="3.  if  判断"></a>3.  if  判断</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function check()</span><br><span class="line">&#123;</span><br><span class="line">    if [ ! -d "$release_name" ]; then</span><br><span class="line">        echo "$release_name"" not exists, check the online dir"</span><br><span class="line">        return</span><br><span class="line">    fi</span><br><span class="line">    if [ -z "$1" ]; then</span><br><span class="line">        echo "must give the dir"</span><br><span class="line">        return</span><br><span class="line">    elif [ ! -d "$1" ]; then</span><br><span class="line">        echo "$1" "not exists please give the dir will online"</span><br><span class="line">        return</span><br><span class="line">    else</span><br><span class="line">        echo "check ok"</span><br><span class="line">        do_online $1</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>-d  判读是不是一个目录，如果是为真</p>
<p>-f   判断是不是一个普通文件，是为真</p>
<p>-z 判断字符的长度是不是为0，为0则为真</p>
<p>==/!=  字符串相等/不等</p>

        
    </section>
</article>




<nav class="page-nav">
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
</nav>


</div>
        <footer class="footer">
    Powered by <a href="http://shiguofu.cn" target="_blank">carlshi</a>,  <a href="https://beian.miit.gov.cn/" target="_blank">鄂ICP备18003559号-1</a>

    
</footer>

    </main>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }
            
            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle();
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp();
            }, 3000);
        }
    });
    </script>
    

</body>
</html>
